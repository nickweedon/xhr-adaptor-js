/*! xhr-adaptor-js 2015-12-06 */
define("xhr-adaptor-js",[],function(){function EventDelegate(a,b){this._xhr=a,this.realHandler=b}function PropMethodFactoryBase(){}function NativePropMethodFactory(){}function ActiveXAwarePropMethodFactory(){}function deriveDebugFactoryFrom(a){function b(){}return b.prototype=Object.create(a.prototype),b.constructor=b,b.prototype.getProperty=function(a,b){return console.debug("Retrieving value for property '"+b+"'"),this._parent().getProperty.apply(this,arguments)},b.prototype.setProperty=function(a,b,c){"_skipPropLog"in a||console.debug("Setting value of property '"+b+"' to: "+c),this._parent().setProperty.apply(this,arguments)},b.prototype.invokeMethod=function(a,b,c){for(var d=[],e=0;e<c.length;e++)d[e]=c[e];return console.debug("Invoking "+b+"("+JSON.stringify(d)+")"),this._parent().invokeMethod.apply(this,arguments)},b.prototype.setEventProperty=function(a,b,c,d,e){console.debug("Setting value of property '"+b+"' to: "+e),a._skipPropLog=!0;try{this._parent().setEventProperty.apply(this,arguments)}finally{delete a._skipPropLog}},b}function XHRWrapperProtoBuilder(a,b){this.factory=a,this.proto=b}function isActiveXObjectSupported(){try{{({})instanceof ActiveXObject}}catch(a){return!1}return!0}function getTypeString(a){var b=/function (.{1,})\(/,c=b.exec(a.constructor.toString());return c&&c.length>1?c[1]:""}function createContinueCallback(a,b,c){return function(d){(d||void 0===d)&&a.applyRealHandler(c),b.isBlocked=!1;var e=xhrAdaptorJs.BlockingRequestQueueXHR.prototype.requestQueue;if(void 0!==e)for(;e.length>0;){var f=xhrAdaptorJs.BlockingRequestQueueXHR.prototype.requestQueue.shift();f()}}}function findResponseHandlerMatch(a){for(var b in this.responseHandlerMap)if(this.responseHandlerMap.hasOwnProperty(b)&&new RegExp(b,"g").test(a))return Object.getPrototypeOf(this).responseHandlerMap[b];return null}function processResponse(a){var b=this,c=findResponseHandlerMatch.call(this._xhr,this._xhr.getRequestURL());return null===c?void b.applyRealHandler(a):c.isBlocked?(this._xhr.resend(),void console.debug("Failed to catch blocked request in time, ignoring response and adding request to queue.")):void c.invokeHandler(this,a)}var xhrAdaptorJs=xhrAdaptorJs||{};EventDelegate.prototype.callRealHandler=function(){this.realHandler.apply(this._xhr,arguments)},EventDelegate.prototype.applyRealHandler=function(a){this.realHandler.apply(this._xhr,a)},Object.defineProperty(EventDelegate.prototype,"xhr",{get:function(){return this._xhr}}),PropMethodFactoryBase.prototype._parent=function(){return Object.getPrototypeOf(Object.getPrototypeOf(this))},PropMethodFactoryBase.prototype.createMethod=function(a){var b=this;return function(){return b.invokeMethod(this.impl,a,arguments)}},PropMethodFactoryBase.prototype.createPropGetter=function(a){var b=this;return function(){return b.getProperty(this.impl,a)}},PropMethodFactoryBase.prototype.createPropSetter=function(a){var b=this;return function(c){b.setProperty(this.impl,a,c)}},PropMethodFactoryBase.prototype.createEvtPropSetter=function(a){var b=this;return function(c){var d=this,e=null;e=a in this.eventDelegate?this.eventDelegate[a]:function(){this.applyRealHandler(arguments)};var f=new EventDelegate(d,c);b.setEventProperty(this.impl,a,f,e,c)}},PropMethodFactoryBase.prototype.getProperty=function(){throw new Error("Must be implemented in subclass!")},PropMethodFactoryBase.prototype.setProperty=function(){throw new Error("Must be implemented in subclass!")},PropMethodFactoryBase.prototype.invokeMethod=function(){throw new Error("Must be implemented in subclass!")},PropMethodFactoryBase.prototype.setEventProperty=function(){throw new Error("Must be implemented in subclass!")},NativePropMethodFactory.prototype=Object.create(PropMethodFactoryBase.prototype),NativePropMethodFactory.constructor=NativePropMethodFactory,NativePropMethodFactory.prototype.getProperty=function(a,b){return a[b]},NativePropMethodFactory.prototype.setProperty=function(a,b,c){a[b]=c},NativePropMethodFactory.prototype.invokeMethod=function(a,b,c){return a[b].apply(a,c)},NativePropMethodFactory.prototype.setEventProperty=function(a,b,c,d){var e=function(){d.apply(c,arguments)};this.setProperty(a,b,e)},ActiveXAwarePropMethodFactory.prototype=Object.create(NativePropMethodFactory.prototype),ActiveXAwarePropMethodFactory.constructor=ActiveXAwarePropMethodFactory,ActiveXAwarePropMethodFactory.prototype.getProperty=function(obj,propertyName){return obj instanceof ActiveXObject?eval("obj."+propertyName+";"):this._parent().getProperty.apply(this,arguments)},ActiveXAwarePropMethodFactory.prototype.setProperty=function(obj,propertyName,value){return obj instanceof ActiveXObject?void eval("obj."+propertyName+" = value;"):this._parent().setProperty.apply(this,arguments)},ActiveXAwarePropMethodFactory.prototype.invokeMethod=function(obj,methodName,args){if(obj instanceof ActiveXObject){var evalStr="obj."+methodName+"(";args.length>0&&(evalStr+="args[0]");for(var i=1;i<args.length;i++)evalStr+=", args["+i+"]";return evalStr+=");",eval(evalStr)}return this._parent().invokeMethod.apply(this,arguments)},XHRWrapperProtoBuilder.prototype.buildMethods=function(){for(var a=0;a<arguments.length;a++){var b=arguments[a];this.proto[b]=this.factory.createMethod(b)}return this},XHRWrapperProtoBuilder.prototype.buildEventProperties=function(){for(var a=0;a<arguments.length;a++){var b=arguments[a];Object.defineProperty(this.proto,b,{get:this.factory.createPropGetter(b),set:this.factory.createEvtPropSetter(b)})}return this},XHRWrapperProtoBuilder.prototype.buildReadWriteProperties=function(){for(var a=0;a<arguments.length;a++){var b=arguments[a];Object.defineProperty(this.proto,b,{get:this.factory.createPropGetter(b),set:this.factory.createPropSetter(b)})}return this},XHRWrapperProtoBuilder.prototype.buildReadOnlyProperties=function(){for(var a=0;a<arguments.length;a++){var b=arguments[a];Object.defineProperty(this.proto,b,{get:this.factory.createPropGetter(b)})}return this},xhrAdaptorJs=xhrAdaptorJs||{},xhrAdaptorJs.XHRWrapper=function(a){console.assert(void 0!==a,"Wrapped implementation must be passed as the first argument to the XHRWrapper constructor."),this.impl=a;for(var b in this.eventDelegate)this[b]=function(){}},xhrAdaptorJs.XHRWrapper.prototype.eventDelegate={},xhrAdaptorJs.XHRWrapper.prototype.parent=function(){return Object.getPrototypeOf(Object.getPrototypeOf(this))},xhrAdaptorJs.XHRWrapper.prototype.parentProperty=function(a){return Object.getOwnPropertyDescriptor(Object.getPrototypeOf(Object.getPrototypeOf(this)),a)};var debugXHR=!1;return function(){var a=isActiveXObjectSupported()?ActiveXAwarePropMethodFactory:NativePropMethodFactory,b=debugXHR?deriveDebugFactoryFrom(a):a,c=new b,d=new XHRWrapperProtoBuilder(c,xhrAdaptorJs.XHRWrapper.prototype);d.buildMethods("abort","getAllResponseHeaders","getResponseHeader","open","overrideMimeType","send","setRequestHeader","init","openRequest","sendAsBinary").buildEventProperties("onreadystatechange","ontimeout","onloadstart","onprogress","onabort","onerror","onload","onloadend").buildReadWriteProperties("responseType","timeout","withCredentials","mozBackgroundRequest","multipart").buildReadWriteProperties("readyState","response","responseText","responseXML","status","statusText","upload","channel","mozAnon","mozSystem","mozResponseArrayBuffer")}(),xhrAdaptorJs=xhrAdaptorJs||{},xhrAdaptorJs.XHRManager=function(){},xhrAdaptorJs.XHRManager.prototype.getXhrClass=function(){return void 0!==window.XMLHttpRequest?window.XMLHttpRequest:function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(a){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}throw new Error("This browser does not support XMLHttpRequest or ActiveX XMLHTTP.")}},xhrAdaptorJs.XHRManager.prototype.injectWrapper=function(a){var b=this.getXhrClass(),c=getTypeString(window.XMLHttpRequest.prototype);"xhrWrapperClosure"!=c&&(window.origXMLHttpRequest=b),XMLHttpRequest=function(){return new a(new b)}},xhrAdaptorJs.XHRManager.prototype.resetXHR=function(){void 0!==window.origXMLHttpRequest&&(window.XMLHttpRequest=window.origXMLHttpRequest)},xhrAdaptorJs.manager=new xhrAdaptorJs.XHRManager,xhrAdaptorJs=xhrAdaptorJs||{},xhrAdaptorJs.BlockingRequestQueueXHR=function(a){this.openArgs=null,this.parent().constructor.call(this,a)},xhrAdaptorJs.BlockingRequestQueueXHR.prototype=Object.create(xhrAdaptorJs.XHRWrapper.prototype),xhrAdaptorJs.BlockingRequestQueueXHR.constructor=xhrAdaptorJs.BlockingRequestQueueXHR,xhrAdaptorJs.BlockingRequestQueueXHR.prototype.responseHandlerMap={},xhrAdaptorJs.BlockingRequestQueueXHR.prototype.requestQueue=[],xhrAdaptorJs.BlockingRequestQueueXHR.prototype.open=function(){this.openArgs=arguments,this.parent().open.apply(this,this.openArgs)},xhrAdaptorJs.BlockingRequestQueueXHR.prototype.send=function(){var a=this,b=arguments,c=findResponseHandlerMatch.call(this,this.getRequestURL());return null!==c&&c.isBlocked?void xhrAdaptorJs.BlockingRequestQueueXHR.prototype.requestQueue.push(function(){a.parent().send.apply(a,b)}):void a.parent().send.apply(a,b)},xhrAdaptorJs.BlockingRequestQueueXHR.prototype.resend=function(){this.open.apply(this,this.openArgs),this.send.apply(this,arguments)},xhrAdaptorJs.BlockingRequestQueueXHR.prototype.getRequestURL=function(){return null===this.openArgs||this.openArgs.length<2?null:this.openArgs[1]},xhrAdaptorJs.BlockingRequestQueueXHR.prototype.getRequestVerb=function(){return null===this.openArgs||this.openArgs.length<1?null:this.openArgs[0]},xhrAdaptorJs.BlockingRequestQueueXHR.prototype.registerResponseHandler=function(a,b,c){if(a in xhrAdaptorJs.BlockingRequestQueueXHR.prototype.responseHandlerMap)return void console.error("Attempted to register handler for existing regex expression '"+a+"'");var d=this,e={handler:b,context:c||d,isBlocked:!1,invokeHandler:function(a,b){e.isBlocked=!0,e.handler.call(c,createContinueCallback(a,e,b),a._xhr)}};xhrAdaptorJs.BlockingRequestQueueXHR.prototype.responseHandlerMap[a]=e},xhrAdaptorJs.BlockingRequestQueueXHR.registerResponseHandler=xhrAdaptorJs.BlockingRequestQueueXHR.prototype.registerResponseHandler,xhrAdaptorJs.BlockingRequestQueueXHR.prototype.unregisterResponseHandler=function(a){delete xhrAdaptorJs.BlockingRequestQueueXHR.prototype.responseHandlerMap[a]},xhrAdaptorJs.BlockingRequestQueueXHR.unregisterResponseHandler=xhrAdaptorJs.BlockingRequestQueueXHR.prototype.unregisterResponseHandler,xhrAdaptorJs.BlockingRequestQueueXHR.prototype.clearResponseHandlers=function(){xhrAdaptorJs.BlockingRequestQueueXHR.prototype.responseHandlerMap={}},xhrAdaptorJs.BlockingRequestQueueXHR.clearResponseHandlers=xhrAdaptorJs.BlockingRequestQueueXHR.prototype.clearResponseHandlers,xhrAdaptorJs.BlockingRequestQueueXHR.prototype.eventDelegate={onreadystatechange:function(){var a=arguments,b=this._xhr;4==b.readyState?processResponse.call(this,a):this.applyRealHandler(a)}},xhrAdaptorJs});